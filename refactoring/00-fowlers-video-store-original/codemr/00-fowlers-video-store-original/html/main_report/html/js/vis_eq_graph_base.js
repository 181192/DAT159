for(var network,allNodes,highlightActive=!1,arrayLength=nodesData.length,i=0;i<arrayLength;i++)nodesData[i].colorx=nodesData[i].color;var nodesDataset=new vis.DataSet(nodesData),edgesDataset=new vis.DataSet(edgesData);function redrawAll(){var e=document.getElementById("mynetwork"),o={nodes:nodesDataset,edges:edgesDataset},l=EQ_generateClassMetricMap(EQ_GET_DATA());(network=new vis.Network(e,o,{nodes:{borderWidth:0},edges:{arrowStrikethrough:!1,smooth:{type:"continuous",roundness:0}},physics:!1,interaction:{tooltipDelay:200,dragView:!1}})).on("selectNode",function(e){var o=e.nodes[0],a=nodesData[o].key;metricvalues=l[a],eQ.MetricChart.updateDots(EQ_convertMetricValues(metricvalues))}),network.on("zoom",function(e){document.getElementById("eventSpan").innerHTML="Zoom Scale: "+parseFloat(Math.round(100*e.scale)/100).toFixed(2)}),allNodes=nodesDataset.get({returnType:"Object"}),assignClusters(clusters),network.on("doubleClick",neighbourhoodHighlight);var n=0,s=0,t=0,d=0;network.on("dragStart",function(e){var o=e.nodes[0];if(void 0===o)return t=e.pointer.canvas.x,void(d=e.pointer.canvas.y);t=e.pointer.canvas.x,d=e.pointer.canvas.y,n=allNodes[o].x-e.pointer.canvas.x,s=allNodes[o].y-e.pointer.canvas.y}),network.on("dragging",function(e){var o=e.nodes[0];if(void 0!==o){if(!e.event.srcEvent.ctrlKey)return t=e.pointer.canvas.x,d=e.pointer.canvas.y,allNodes[o].x=e.pointer.canvas.x+n,void(allNodes[o].y=e.pointer.canvas.y+s);var a=allNodes[o].cls;0<=a&&(moveCluster(clusters[a],clustersBounds[a],e.pointer.canvas.x-t,e.pointer.canvas.y-d),t=e.pointer.canvas.x,d=e.pointer.canvas.y)}}),network.on("dragEnd",function(e){var o=e.nodes[0];if(void 0===o)return 0<=(a=findBoudingCluster(clustersBounds,t,d))?void moveCluster(clusters[a],clustersBounds[a],e.pointer.canvas.x-t,e.pointer.canvas.y-d):void 0;if(e.event.srcEvent.ctrlKey){var a;if((a=allNodes[e.nodes[0]].cls)<0)return;moveCluster(clusters[a],clustersBounds[a],e.pointer.canvas.x-t,e.pointer.canvas.y-d)}else allNodes[o].x=e.pointer.canvas.x+n,allNodes[o].y=e.pointer.canvas.y+s}),network.on("beforeDrawing",function(e){calculateClusterBounds(clusters,clustersBounds);for(var o=clusters.length,a=0;a<o;a++)drawACluster(e,clustersBounds[a])})}function neighbourhoodHighlight(e){if(0<e.nodes.length){var o,a;highlightActive=!0;var l=e.nodes[0];for(var n in allNodes)allNodes[n].color="rgba(200,200,200,0.5)",void 0===allNodes[n].hiddenLabel&&(allNodes[n].hiddenLabel=allNodes[n].label,allNodes[n].label=void 0);var s=network.getConnectedNodes(l),t=[];for(o=1;o<2;o++)for(a=0;a<s.length;a++)t=t.concat(network.getConnectedNodes(s[a]));for(o=0;o<t.length;o++)allNodes[t[o]].color="rgba(150,150,150,0.75)",void 0!==allNodes[t[o]].hiddenLabel&&(allNodes[t[o]].label=allNodes[t[o]].hiddenLabel,allNodes[t[o]].hiddenLabel=void 0);for(o=0;o<s.length;o++)allNodes[s[o]].color=allNodes[s[o]].colorx,void 0!==allNodes[s[o]].hiddenLabel&&(allNodes[s[o]].label=allNodes[s[o]].hiddenLabel,allNodes[s[o]].hiddenLabel=void 0);allNodes[l].color=allNodes[l].colorx,void 0!==allNodes[l].hiddenLabel&&(allNodes[l].label=allNodes[l].hiddenLabel,allNodes[l].hiddenLabel=void 0)}else if(!0===highlightActive){for(var n in allNodes)allNodes[n].color=allNodes[n].colorx,void 0!==allNodes[n].hiddenLabel&&(allNodes[n].label=allNodes[n].hiddenLabel,allNodes[n].hiddenLabel=void 0);highlightActive=!1}var d=[];for(n in allNodes)allNodes.hasOwnProperty(n)&&d.push(allNodes[n]);nodesDataset.update(d)}redrawAll();
